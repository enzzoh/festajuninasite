<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Letreco</title>
    <link rel="stylesheet" href="sytle.css">
</head>

<body class="body">
    <div class="box">

        <div class="app-container">
            <div class="title-container">
                <h1>

                    <span>L</span>
                    <span>E</span>
                    <span class="letter-yellow">T</span>
                    <span>R</span>
                    <span class="letter-red">E</span>
                    <span>C</span>
                    <span class="letter-green">O</span>
                </h1>


            </div>
            <div class="tile-container"></div>
            <div class="keyboard-container">

                <div class="keyboard-row-container notAlphabetic" id="backspaceAndEnterRow"></div>
                <div class="keyboard-row-container" id="keyboardFirstRow"></div>
                <div class="keyboard-row-container" id="keyboardSecondRow"></div>
                <div class="keyboard-row-container" id="keyboardThirdRow"></div>
            </div>



        </div>



    </div>
   
    <script>


        const tiles = document.querySelector(".tile-container");
        const backspaceAndEnterRow = document.querySelector("#backspaceAndEnterRow");
        const keyboardFirstRow = document.querySelector("#keyboardFirstRow");
        const keyboardSecondRow = document.querySelector("#keyboardSecondRow");
        const keyboardThirdRow = document.querySelector("#keyboardThirdRow");

        const keysFirstRow = ["Q", "W", "E", "R", "T", "Y", "U", "I", "O", "P"];
        const keysSecondRow = ["A", "S", "D", "F", "G", "H", "J", "K", "L"];
        const keysThirdRow = ["Z", "X", "C", "V", "B", "N", "M"];

        const rows = 6;
        const columns = 5;
        let currentRow = 0;
        let currentColumn = 0;
        let letreco = "MILHO";
        let letrecoMap = {};
        for (let index = 0; index < letreco.length; index++) {
            letrecoMap[letreco[index]] = index;
        }
        const guesses = [];

        for (let rowIndex = 0; rowIndex < rows; rowIndex++) {
            guesses[rowIndex] = new Array(columns);
            const tileRow = document.createElement("div");
            tileRow.setAttribute("id", "row" + rowIndex);
            tileRow.setAttribute("class", "tile-row");
            for (let columnIndex = 0; columnIndex < columns; columnIndex++) {
                const tileColumn = document.createElement("div");
                tileColumn.setAttribute("id", "row" + rowIndex + "column" + columnIndex);
                tileColumn.setAttribute(
                    "class",
                    rowIndex === 0 ? "tile-column typing" : "tile-column disabled"
                );
                tileRow.append(tileColumn);
                guesses[rowIndex][columnIndex] = "";
            }
            tiles.append(tileRow);
        }

      // Função para verificar se uma palavra é válida na língua portuguesa usando a API do Dicionário Aberto
      async function verificarPalavra(palavra) {
    const url = `https://api.dicionario-aberto.net/word/${palavra}`;
    try {
        const response = await fetch(url);
        if (response.ok) {
            const data = await response.json();
            console.log("Resposta da API:", data); // Verifica o que a API retorna
            if (data.length > 0) {
                return true; // A palavra é válida
            } else {
                return false; // A palavra não é válida
            }
        } else {
            throw new Error('Erro ao consultar a API');
        }
    } catch (error) {
        console.error('Erro:', error.message);
        return false; // Trata qualquer erro como palavra inválida
    }
}

// Função para verificar a palavra digitada pelo usuário
const checkGuess = async () => {
    const guess = guesses[currentRow].join("");
    if (guess.length !== columns) {
        return;
    }

    // Verifica se a palavra é válida na língua portuguesa
    const isValidWord = await verificarPalavra(guess.toLowerCase());
    if (!isValidWord) {
        alert('Por favor, insira uma palavra válida na língua portuguesa.');
        return;
    }

    // Continuação da sua lógica existente...

    var currentColumns = document.querySelectorAll(".typing");
    for (let index = 0; index < columns; index++) {
        const letter = guess[index];
        if (letrecoMap[letter] === undefined) {
            currentColumns[index].classList.add("wrong")
        } else {
            if (letrecoMap[letter] === index) {
                currentColumns[index].classList.add("right")
            } else {
                currentColumns[index].classList.add("displaced")
            }
        }
    }

    if (guess === letreco) {
        window.alert("Tu é demais, simplesmente o detetivão do entretenimento!");
        return;
    } else {
        if (currentRow === rows - 1) {
            window.alert("Errrrrrou!");
        } else {
            moveToNextRow();
        }
    }
};
        const moveToNextRow = () => {
            var typingColumns = document.querySelectorAll(".typing")
            for (let index = 0; index < typingColumns.length; index++) {
                typingColumns[index].classList.remove("typing")
                typingColumns[index].classList.add("disabled")
            }
            currentRow++
            currentColumn = 0

            const currentRowEl = document.querySelector("#row" + currentRow)
            var currentColumns = currentRowEl.querySelectorAll(".tile-column")
            for (let index = 0; index < currentColumns.length; index++) {
                currentColumns[index].classList.remove("disabled")
                currentColumns[index].classList.add("typing")
            }
        }

        const handleKeyboardOnClick = (key) => {
            if (currentColumn === columns) {
                return;
            }
            const currentTile = document.querySelector(
                "#row" + currentRow + "column" + currentColumn
            );
            currentTile.textContent = key;
            guesses[currentRow][currentColumn] = key;
            currentColumn++;
        };

        const createKeyboardRow = (keys, keyboardRow) => {
            keys.forEach((key) => {
                var buttonElement = document.createElement("button");
                buttonElement.textContent = key;
                buttonElement.setAttribute("id", key);
                buttonElement.addEventListener("click", () => handleKeyboardOnClick(key));
                keyboardRow.append(buttonElement);
            });
        };

        createKeyboardRow(keysFirstRow, keyboardFirstRow);
        createKeyboardRow(keysSecondRow, keyboardSecondRow);
        createKeyboardRow(keysThirdRow, keyboardThirdRow);

        const handleBackspace = () => {
            if (currentColumn === 0) {
                return
            }

            currentColumn--
            guesses[currentRow][currentColumn] = ""
            const tile = document.querySelector("#row" + currentRow + "column" + currentColumn)
            tile.textContent = ""
        };

        const backspaceButton = document.createElement("button");
        backspaceButton.addEventListener("click", handleBackspace);
        backspaceButton.textContent = "DELETE";
        backspaceAndEnterRow.append(backspaceButton);

        const enterButton = document.createElement("button");
        enterButton.addEventListener("click", checkGuess);
        enterButton.textContent = "ENTER";
        backspaceAndEnterRow.append(enterButton);

        document.onkeydown = function (evt) {
            evt = evt || window.evt
            if (evt.key === "Enter") {
                checkGuess();
            } else if (evt.key === "Backspace") {
                handleBackspace()
            } else {
                handleKeyboardOnClick(evt.key.toUpperCase())
            }
        }

 



    </script>
</body>

</html>